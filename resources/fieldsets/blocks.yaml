title: Blocks
fields:
  -
    handle: blocks
    field:
      type: replicator
      localizable: true
      collapse: true
      listable: false
      display: Blocks
      instructions: 'Build your page by using various predefined content models.'
      button_label: 'Add Block'
      sets:
        main:
          display: Main
          sets:
            product_cards:
              display: Product Cards
              instructions: Place a Commerce7 products collection.
              icon: dashboard-layout
              fields:
                - handle: c7_collection_slug
                  field:
                    type: slug
                    display: Collection Slug
                    instructions: Enter the Commerce7 collection slug (Store → Collections → Desired Collection → SEO → Slug).
                    validate:
                      - required

                - handle: audience
                  field:
                    type: select
                    display: Visibility
                    instructions: Choose who can see this block.
                    options:
                      all: All visitors
                      members: Logged-in members only
                    clearable: false
                    multiple: false
                    searchable: false
                    default: all
                    validate:
                      - required

                - handle: guest_message
                  field:
                    type: textarea
                    display: Guest Message
                    instructions: Message shown to visitors who aren’t logged in.
                    placeholder: Log in to view member products.
                    antlers: false
                    if:
                      audience: equals members
      
                - handle: c7_notice
                  field:
                    type: html
                    display: This is a Commerce7 block:
                    antlers: false
                    html: |
                      <div class="help-block">
                      <p>Products shown are pulled automatically from the Commerce7 product collection specified by the title.</p>
                      <p>Manage products and promotions: <a href="https://admin.commerce7.com/" target="_blank" rel="noopener">Open Commerce7</a></p>
                      </div>

            wine_club_signup:
              display: Wine Club Signup
              instructions: 'Links to the Commerce7 clubs set to Web Status > Available.'
              icon: dashboard-layout
              fields:
                - handle: heading
                  field:
                    type: text
                    display: Heading
                    instructions: Optional. Short headline above the club signup list.
                    antlers: false

                - handle: intro
                  field:
                    type: textarea
                    display: Intro
                    instructions: Optional. Short supporting text.
                    antlers: false

                - handle: clubs
                  field:
                    type: grid
                    display: Clubs
                    instructions: 'Add one row per club to show. Club slug must match Commerce7. Clubs must be set to Web Status > Available in Commerce7.'
                    add_row: Add Club
                    mode: stacked
                    fields:
                      - handle: club_slug
                        field:
                          type: text
                          display: Club Slug
                          instructions: 'Commerce7 club slug.'
                          antlers: false
                          validate:
                            - required

                      - handle: club_name
                        field:
                          type: text
                          display: Club Name
                          instructions: 'Club name (may be different from Commerce7).'
                          antlers: false
                          validate:
                            - required

                      - handle: join_text
                        field:
                          type: text
                          display: Join Button
                          instructions: 'Button text when the user is not a member.'
                          antlers: false
                          default: Join Club

                      - handle: edit_text
                        field:
                          type: text
                          display: Edit Button
                          instructions: 'Button text when the user already has a membership to edit.'
                          antlers: false
                          default: Edit Club Membership

                      - handle: description
                        field:
                          type: bard
                          display: Club Description
                          instructions: 'Description shown above/beside the join button.'
                          antlers: false
                          buttons:
                            - bold
                            - italic
                            - unorderedlist
                            - orderedlist
                            - link
                          toolbar_mode: floating

                      - handle: bottle_count
                        field:
                          type: integer
                          display: Number of Bottles
                          instructions: 'Number of bottles included in each shipment.'
                          antlers: false
                          validate:
                            - min:1

                      - handle: fulfillment
                        field:
                          type: toggle
                          display: Shipping
                          instructions: 'Toggle on (green) for Shipping, off for Will Call.'
                          antlers: false
                          inline_label_when_true: Ship
                          inline_label_when_false: Will Call

                      - handle: frequency_value
                        field:
                          type: integer
                          display: Frequency
                          instructions: 'How often does the club ship per interval.'
                          antlers: false
                          validate:
                            - min:1

                      - handle: frequency_unit
                        field:
                          type: select
                          display: Frequency Unit
                          instructions: 'Unit for the club shipping frequency.'
                          antlers: false
                          options:
                            month: Month(s)
                            year: Year(s)
                          default: month

            promo_cards:
              display: Promo Area
              instructions: 'Promotional cards: recipes, events, wines.'
              icon: dashboard-layout
              fields:
                - handle: cards
                  field:
                    type: grid
                    antlers: true 
                    display: Cards
                    instructions: 'Add up to 9 promo cards. Drag to reorder.'
                    mode: stacked
                    reorderable: true
                    min_rows: 1
                    max_rows: 9

                    fields:

                      - handle: members_only
                        field:
                          type: toggle
                          display: Members only?
                          instructions: 'If on, this card only renders for logged-in members.'
                          default: false
                          width: 33

                      - handle: heading
                        field:
                          type: text
                          display: Card Title
                          instructions: 'Headline / promo name.'
                          validate:
                            - required
                          width: 50

                      - handle: subtitle
                        field:
                          type: text
                          display: Subtitle
                          instructions: 'Optional short subheading.'
                          width: 50

                      - handle: body
                        field:
                          type: textarea
                          display: Body Text
                          instructions: 'Optional short paragraph/description for this promo.'
                          rows: 3

                      - handle: link_type
                        field:
                          type: select
                          display: Link Type
                          instructions: 'Choose how (or if) this card links.'
                          options:
                            none: No link
                            internal: Internal Entry
                            external: External URL
                          default: none
                          width: 33

                      - handle: link_entry
                        field:
                          type: entries
                          display: Internal Link (Entry)
                          instructions: 'Pick an internal page/entry to link to.'
                          max_items: 1
                          if:
                            link_type: equals internal
                          width: 33

                      - handle: link_url
                        field:
                          type: text
                          display: External Link (URL)
                          instructions: 'Full external URL (Tock, booking, etc).'
                          input_type: url
                          if:
                            link_type: equals external
                          width: 33

                      - handle: bg_type
                        field:
                          type: select
                          display: Background Type
                          instructions: 'Use an uploaded image (with focal point) or a solid color.'
                          options:
                            image: Image
                            color: Color
                          default: image
                          width: 33

                      - handle: bg_image
                        field:
                          type: assets
                          display: Background Image
                          instructions: 'Upload/select a background image. You can set focal point.'
                          max_files: 1
                          container: promo_images
                          allow_uploads: true
                          if:
                            bg_type: equals image
                          width: 66

                      - handle: bg_color
                        field:
                          type: color
                          display: Background Color
                          instructions: 'Used if no image.'
                          swatches:
                            - '#000000'
                            - '#ffffff'
                            - '#cccccc'
                          if:
                            bg_type: equals color
                          width: 33

            recipes_listing:
              display: 'Recipes Listing'
              icon: layout-three-columns
              fields:
                -
                  import: recipes_listing

            recipe:
              display: Recipe
              icon: text-format
              fields:
                -
                  handle: title
                  field:
                    type: text
                    display: Title
                    validate:
                      - required

                -
                  handle: description
                  field:
                    type: textarea
                    display: Description
                    rows: 3

                -
                  handle: servings
                  field:
                    type: text
                    display: Servings
                    width: 33
                    instructions: e.g. 4–6

                -
                  handle: prep_time
                  field:
                    type: text
                    display: Prep Time
                    width: 33
                    instructions: e.g. 15 min

                -
                  handle: cook_time
                  field:
                    type: text
                    display: Cook Time
                    width: 33
                    instructions: e.g. 25 min

                -
                  handle: image
                  import: picture

                -
                  handle: ingredients
                  field:
                    type: markdown
                    display: Ingredients

                -
                  handle: instructions
                  field:
                    type: markdown
                    display: Instructions

                -
                  handle: notes
                  field:
                    type: markdown
                    display: Notes      

            article:
              display: Article
              instructions: 'Long form content, can be expanded with picture, video, quotes or tables.'
              icon: text-formatting-image-bottom
              fields:
                -
                  import: article
            blog_excerpt:
              display: 'Blog Excerpt'
              icon: layout-three-columns
              fields:
                -
                  import: blog_excerpt
            blog_paginated:
              display: 'Blog Paginated'
              icon: layout-grid-dots
              fields:
                -
                  import: blog_paginated
            contact:
              display: Contact
              icon: phone-contact-phonebook
              fields:
                -
                  import: contact
            faqs:
              display: FAQs
              icon: alert-help-question
              fields:
                -
                  import: faqs
            hero_home:
              display: 'Hero Home'
              icon: align-object-top
              fields:
                -
                  import: hero_home
            newsletter:
              display: Newsletter
              icon: social-mail-send-email-message
              fields:
                -
                  import: newsletter
            search_form:
              display: 'Search form'
              icon: search-magnifying-glass
              fields:
                -
                  import: search_form
            search_results:
              display: 'Search Results'
              icon: text-formatting-image-bottom
              fields:
                -
                  import: search_results
            style_guide:
              display: 'Style Guide'
              instructions: 'Styles and components in one place.'
              icon: edit-paint-palette
              fields:
                -
                  import: style_guide
            team:
              display: Team
              icon: user-multiple
              fields:
                -
                  import: team
            testimonials:
              display: Testimonials
              icon: text-formatting-quotation
              fields:
                -
                  import: testimonials
